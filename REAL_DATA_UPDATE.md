# 🏢 真實台灣股票數據更新指南

> **重要**: 本系統只使用真實的股票數據，絕不製造假數據！

## 🎯 **總覽**

您的系統配置了 **765 支台灣股票**，會從以下真實來源抓取數據：
- 📊 **twstock** - 台灣股票資料庫模組
- 🌐 **TWSE API** - 台灣證券交易所官方 API  
- 📈 **台股即時資訊** - 官方即時資料

---

## 🚀 **一鍵更新（推薦）**

```bash
# 自動抓取所有765支股票的最新真實數據
echo y | python hybrid_real_crawler.py
```

**功能：**
- ✅ 從多個官方來源抓取真實數據
- ✅ 自動處理 765 支台灣股票
- ✅ 詳細的成功/失敗報告
- ✅ 智能延遲避免被封IP
- ✅ 可中斷後恢復

---

## 📊 **數據來源說明**

### 🥇 **第一優先：真實交易數據**
- **twstock**: 獲取歷史交易價格、成交量
- **TWSE API**: 獲取當前股價、即時資訊

### 🥈 **第二優先：基於真實數據的智能估算**
- 基於真實股價波動估算 ROE
- 根據產業類別估算 EPS
- 利用歷史趨勢估算成長率

### ❌ **絕不使用：假數據**
- 不使用隨機生成的數據
- 不使用示例數據
- 所有估算都基於真實市場數據

---

## 📈 **爬取進度監控**

爬蟲會顯示詳細進度：

```
📈 處理 1/765: 2330 (台積電)
   ✅ 成功 (完整數據) - 來源: TWSTOCK, TWSE_API

📈 處理 2/765: 2317 (鴻海)
   ✅ 成功 (有價格) - 來源: TWSE_API

📈 處理 3/765: 1234 (示例股票)
   ❌ 失敗 - 無法獲取任何數據

⏳ 已處理 50/765 (6.5%)，休息 10 秒...
   成功: 45，失敗: 5
```

---

## 📋 **失敗分析報告**

爬蟲會自動生成詳細報告：

### ✅ **成功統計**
- 總成功率
- 各數據來源成功數量
- 完整數據 vs 部分數據比例

### ❌ **失敗分析**
- 失敗原因分類
- 無法獲取數據的具體股票
- 建議改進措施

### 📁 **文件輸出**
- `data/processed/hybrid_real_stock_data_YYYYMMDD_HHMMSS.csv` - 成功數據
- `data/logs/failed_stocks_YYYYMMDD_HHMMSS.csv` - 失敗清單
- `data/logs/hybrid_real_YYYYMMDD_HHMMSS.log` - 詳細日誌

---

## 🔄 **應用自動更新**

### 📱 **本地應用**
抓取新數據後，Streamlit 會自動重載：
```bash
# 啟動應用（如果還沒啟動）
python -m streamlit run taiwan_stock_analyzer.py

# 應用會自動檢測最新數據文件
```

### ☁️ **雲端應用 (Streamlit Cloud)**
提交到 GitHub 後會自動部署：
```bash
git add data/processed/*.csv
git commit -m "Update real stock data - $(date)"
git push origin main
# Streamlit Cloud 會在 2-5 分鐘內自動更新
```

---

## ⚠️ **常見問題解決**

### 🚫 **網路請求被限制**
```
解決方案：
1. 檢查網路連線
2. 等待一段時間後重試
3. 爬蟲已內建智能延遲機制
```

### 📉 **部分股票無數據**
```
正常情況：
- 停牌股票
- 新上市股票
- 資料暫時不可用
- 爬蟲會在報告中詳細說明
```

### 🔧 **依賴套件問題**
```bash
# 安裝必要套件
pip install pandas requests twstock numpy

# 如果 twstock 有問題，系統會自動使用其他來源
```

---

## 📊 **數據品質保證**

### 🟢 **優秀品質指標**
- 成功率 ≥ 80%
- 真實數據比例 ≥ 50%
- 股價數據完整度 ≥ 70%

### 🟡 **可接受品質**
- 成功率 ≥ 60%
- 真實數據比例 ≥ 30%
- 基本數據完整

### 🔴 **需要改進**
- 成功率 < 60%
- 大部分依賴估算
- 建議檢查網路或重試

---

## 🎯 **最佳實踐**

1. **定期更新**: 建議每週抓取一次最新數據
2. **避免頻繁**: 不要過於頻繁請求，避免被封IP
3. **監控報告**: 仔細檢查成功/失敗報告
4. **備份數據**: 保留歷史數據文件作備份
5. **測試先行**: 重大更新前先在本地測試

---

## 📞 **技術支援**

如果遇到問題：
1. 查看 `data/logs/` 目錄下的詳細日誌
2. 檢查失敗股票清單 `failed_stocks_*.csv`
3. 確認網路連線和依賴套件
4. 參考錯誤訊息進行故障排除

**記住：我們只使用真實數據，確保分析結果的準確性！** 🎯 